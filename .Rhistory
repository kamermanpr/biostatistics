d1.dens <- density(d1)
d1.dens <- data_frame(x = d1.dens$x, y = d1.dens$y)
# calculate quantiles for d1
q0 <- quantile(d1, 0)
q2.5 <- quantile(d1, 0.025)
q95 <- quantile(d1, 0.95)
q97.5 <- quantile(d1, 0.975)
q100 <- quantile(d1, 1)
# data.frame
dens_97.5 <- d1.dens %>%
filter(x > q97.5 & x < q100) %>%
mutate(quant = rep('q97.5', length(x)))
dens_95 <- d1.dens %>%
filter(x > q95 & x < q100) %>%
mutate(quant = rep('q95', length(x)))
dens_2.5 <- d1.dens %>%
filter(x > q0 & x < q2.5) %>%
mutate(quant = rep('q2.5', length(x)))
ribbon <- do.call(rbind, list(dens_97.5, dens_95, dens_2.5))
tails <- ggplot(ribbon, aes(ymax = y, x = x,
group = quant,
frame = quant, )) +
geom_ribbon(aes(cumulative = TRUE),
ymin = 0, fill = "red", colour = 'black') +
geom_density(df1, aes(values))
tails <- ggplot(ribbon, aes(ymax = y, x = x,
group = quant,
frame = quant, )) +
geom_ribbon(aes(cumulative = TRUE),
ymin = 0, fill = "red", colour = 'black') +
geom_density(data = df1, aes(values))
tails <- ggplot(ribbon, aes(ymax = y, x = x,
group = quant,
frame = quant, )) +
geom_ribbon(aes(cumulative = TRUE),
ymin = 0, fill = "red", colour = 'black') +
geom_density(data = df1, aes(values)) +
labs(title = 'One-tailed at 5% threshold',
y = 'Density\n') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
tails <- ggplot(ribbon, aes(ymax = y, x = x,
group = quant,
frame = quant, )) +
geom_ribbon(aes(cumulative = TRUE),
ymin = 0, fill = "red", colour = 'black') +
geom_density(data = df1, aes(values)) +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
tails <- ggplot(ribbon, aes(y = y, x = x,
group = quant,
frame = quant, )) +
geom_ribbon(aes(ymax = y, cumulative = TRUE),
ymin = 0, fill = "red", colour = 'black') +
geom_density(data = df1, aes(values)) +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
tails <- ggplot(ribbon, aes(x = x,
group = quant,
frame = quant, )) +
geom_ribbon(aes(ymax = y, cumulative = TRUE),
ymin = 0, fill = "red", colour = 'black') +
geom_density(data = df1, aes(x = values)) +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
tails <- ggplot(ribbon, aes(x = x,
group = quant,
frame = quant)) +
geom_ribbon(aes(ymax = y, cumulative = TRUE),
ymin = 0, fill = "red", colour = 'black') +
geom_density(data = df1, aes(x = values)) +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
tails <- ggplot(ribbon, aes(x = x)) +
geom_ribbon(aes(ymax = y,
group = quant,
frame = quant,
cumulative = TRUE),
ymin = 0, fill = "red", colour = 'black') +
geom_density(data = df1, aes(x = values)) +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
tails <- ggplot(ribbon, aes(x = x)) +
geom_ribbon(aes(ymax = y,
group = quant,
frame = quant,
cumulative = TRUE),
ymin = 0, fill = "red", colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = 'Two-tailed at 5% threshold',
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
gg_animate(tails, interval = 2, './resources/tails.gif')
tails <- ggplot(ribbon, aes(x = x)) +
geom_ribbon(aes(ymax = y,
group = quant,
frame = quant,
cumulative = TRUE),
ymin = 0, fill = "red", colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = 'Two-tailed at 5% threshold',
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
gg_animate(tails, interval = 2)
tails <- ggplot(ribbon) +
geom_ribbon(aes(ymax = y,
group = quant,
frame = quant,
cumulative = TRUE),
ymin = 0, fill = "red", colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = 'Two-tailed at 5% threshold',
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
group = quant,
frame = quant,
cumulative = TRUE),
ymin = 0, fill = "red", colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = 'Two-tailed at 5% threshold',
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
dens_97.5 <- d1.dens %>%
filter(x > q97.5 & x < q100) %>%
mutate(quant = rep('q97.5', length(x)),
colour = rep('orange', length(x)))
dens_95 <- d1.dens %>%
filter(x > q95 & x < q100) %>%
mutate(quant = rep('q95', length(x)),
colour = rep('blue', length(x)))
dens_2.5 <- d1.dens %>%
filter(x > q0 & x < q2.5) %>%
mutate(quant = rep('q2.5', length(x)),
colour = rep('orange', length(x)))
ribbon <- do.call(rbind, list(dens_97.5, dens_95, dens_2.5))
ribbon
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
colour = colour,
group = quant,
frame = quant,
cumulative = TRUE),
ymin = 0, fill = "red", colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = 'Two-tailed at 5% threshold',
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = quant,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = 'Two-tailed at 5% threshold',
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
gg_animate(tails, interval = 2)
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = 'Two-tailed at 5% threshold',
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
gg_animate(tails, interval = 2)
d1 <- rnorm(1000000, mean = 0, sd = 1)
# Combine into dataframes
df1 <- data_frame(values = d1)
# Calculate density of d1 and put into a dataframe
d1.dens <- density(d1)
d1.dens <- data_frame(x = d1.dens$x, y = d1.dens$y)
# calculate quantiles for d1
q0 <- quantile(d1, 0)
q2.5 <- quantile(d1, 0.025)
q95 <- quantile(d1, 0.95)
q97.5 <- quantile(d1, 0.975)
q100 <- quantile(d1, 1)
# data.frame
dens_97.5 <- d1.dens %>%
filter(x > q97.5 & x < q100) %>%
mutate(quant = rep('q97.5', length(x)),
colour = rep('two-tailed', length(x)))
dens_95 <- d1.dens %>%
filter(x > q95 & x < q100) %>%
mutate(quant = rep('q95', length(x)),
colour = rep('one-tailed', length(x)))
dens_2.5 <- d1.dens %>%
filter(x > q0 & x < q2.5) %>%
mutate(quant = rep('q2.5', length(x)),
colour = rep('two-tailed', length(x)))
ribbon <- do.call(rbind, list(dens_97.5, dens_95, dens_2.5))
ribbon
# Plots
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = 'Two-tailed at 5% threshold',
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
gg_animate(tails, interval = 2)
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = expression($\alpha = 0.05$),
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
gg_animate(tails, interval = 2)
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = expression(paste(alpha '= 0.05')),
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
gg_animate(tails, interval = 2)
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = expression(paste(alpha '= 0.05')),
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = expression(alpha),
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = expression(paste(alpha, '= 0.05')),
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = expression(paste(alpha, '= 0.05')),
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 18))
tails
# Plots
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(title = expression(paste(alpha, ' = 0.05')),
y = 'Density\n', x = '\nValues') +
theme_cowplot() +
theme(plot.title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
gg_animate(tails, interval = 2)
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(y = 'Density\n', x = '\nValues') +
scale_fill_manual(values = c('(one-tailed)' = '#D55E00',
'(two-tailed)' = '#0072B2')) +
theme_cowplot() +
theme(legend.position = none,
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(y = 'Density\n', x = '\nValues') +
scale_fill_manual(values = c('(one-tailed)' = '#D55E00',
'(two-tailed)' = '#0072B2')) +
theme_cowplot() +
theme(legend.position = 'none',
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(y = 'Density\n', x = '\nValues') +
scale_fill_manual(values = c('#D55E00', '#0072B2')) +
theme_cowplot() +
theme(legend.position = 'none',
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = TRUE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(y = 'Density\n', x = '\nValues') +
scale_fill_manual(values = c('#0072B2', '#E69F00')) +
theme_cowplot() +
theme(legend.position = 'none',
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
gg_animate(tails, interval = 2)
tails <- ggplot(ribbon) +
geom_ribbon(aes(x = x,
ymax = y,
fill = colour,
group = quant,
frame = colour,
cumulative = FALSE),
ymin = 0, colour = 'black') +
geom_density(data = df1, aes(x = values)) +
labs(y = 'Density\n', x = '\nValues') +
scale_fill_manual(values = c('#0072B2', '#E69F00')) +
theme_cowplot() +
theme(legend.position = 'none',
axis.text = element_text(size = 20),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title = element_text(size = 20))
tails
gg_animate(tails, interval = 2)
gg_animate(tails, interval = 2, './resources/tails.gif')
